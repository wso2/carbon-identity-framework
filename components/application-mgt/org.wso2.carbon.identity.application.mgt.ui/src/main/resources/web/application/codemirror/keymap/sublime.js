'use strict';var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(e,q,p){e instanceof String&&(e=String(e));for(var r=e.length,t=0;t<r;t++){var v=e[t];if(q.call(p,v,t,e))return{i:t,v:v}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,q,p){e!=Array.prototype&&e!=Object.prototype&&(e[q]=p.value)};
$jscomp.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:"undefined"!=typeof global&&null!=global?global:e};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(e,q,p,r){if(q){p=$jscomp.global;e=e.split(".");for(r=0;r<e.length-1;r++){var t=e[r];t in p||(p[t]={});p=p[t]}e=e[e.length-1];r=p[e];q=q(r);q!=r&&null!=q&&$jscomp.defineProperty(p,e,{configurable:!0,writable:!0,value:q})}};
$jscomp.polyfill("Array.prototype.find",function(e){return e?e:function(e,p){return $jscomp.findInternal(this,e,p).v}},"es6-impl","es3");
(function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],e):e(CodeMirror)})(function(e){function q(a,d){a.extendSelectionsBy(function(c){if(a.display.shift||a.doc.extend||c.empty()){var f=a.doc;c=c.head;if(0>d&&0==c.ch)var l=f.clipPos(m(c.line-1));else{var w=
f.getLine(c.line);if(0<d&&c.ch>=w.length)l=f.clipPos(m(c.line+1,0));else{for(var f="start",g=c.ch,b=0>d?0:w.length,h=0;g!=b;g+=d,h++){var k=w.charAt(0>d?g-1:g),n="_"!=k&&e.isWordChar(k)?"w":"o";"w"==n&&k.toUpperCase()==k&&(n="W");if("start"==f)"o"!=n&&(f="in",l=n);else if("in"==f&&l!=n)if("w"==l&&"W"==n&&0>d&&g--,"W"==l&&"w"==n&&0<d)l="w";else break}l=m(c.line,g)}}return l}return 0>d?c.from():c.to()})}function p(a,d){if(a.isReadOnly())return e.Pass;a.operation(function(){for(var c=a.listSelections().length,
f=[],l=-1,b=0;b<c;b++){var g=a.listSelections()[b].head;g.line<=l||(l=m(g.line+(d?0:1),0),a.replaceRange("\n",l,null,"+insertLine"),a.indentLine(l.line,null,!0),f.push({head:l,anchor:l}),l=g.line+1)}a.setSelections(f)});a.execCommand("indentAuto")}function r(a,d){var c=d.ch,f=c;for(a=a.getLine(d.line);c&&e.isWordChar(a.charAt(c-1));)--c;for(;f<a.length&&e.isWordChar(a.charAt(f));)++f;return{from:m(d.line,c),to:m(d.line,f),word:a.slice(c,f)}}function t(a,d){for(var c=a.listSelections(),f=[],l=0;l<
c.length;l++){var b=c[l],g=a.findPosV(b.anchor,d,"line"),e=a.findPosV(b.head,d,"line"),g={anchor:g,head:e};f.push(b);f.push(g)}a.setSelections(f)}function v(a){for(var d=a.listSelections(),c=[],f=0;f<d.length;f++){var l=d[f].head,b=a.scanForBracket(l,-1);if(!b)return!1;for(;;){l=a.scanForBracket(l,1);if(!l)return!1;if(l.ch=="(){}[]".charAt("(){}[]".indexOf(b.ch)+1)){c.push({anchor:m(b.pos.line,b.pos.ch+1),head:l.pos});break}l=m(l.pos.line,l.pos.ch+1)}}a.setSelections(c);return!0}function x(a,d){if(a.isReadOnly())return e.Pass;
for(var c=a.listSelections(),f=[],l,b=0;b<c.length;b++){var g=c[b];if(!g.empty()){for(var h=g.from().line,g=g.to().line;b<c.length-1&&c[b+1].from().line==g;)g=c[++b].to().line;c[b].to().ch||g--;f.push(h,g)}}f.length?l=!0:f.push(a.firstLine(),a.lastLine());a.operation(function(){for(var c=[],b=0;b<f.length;b+=2){var g=f[b+1],e=m(f[b],0),h=m(g),k=a.getRange(e,h,!1);d?k.sort():k.sort(function(a,c){var d=a.toUpperCase(),f=c.toUpperCase();d!=f&&(a=d,c=f);return a<c?-1:a==c?0:1});a.replaceRange(k,e,h);
l&&c.push({anchor:e,head:m(g+1,0)})}l&&a.setSelections(c,0)})}function y(a,d){a.operation(function(){for(var c,f=a.listSelections(),l=[],b=[],g=0;g<f.length;g++)c=f[g],c.empty()?(l.push(g),b.push("")):b.push(d(a.getRange(c.from(),c.to())));a.replaceSelections(b,"around","case");for(var g=l.length-1,h;0<=g;g--)c=f[l[g]],h&&0<e.cmpPos(c.head,h)||(c=r(a,c.head),h=c.from,a.replaceRange(d(c.word),c.from,c.to))})}function z(a){var d=a.getCursor("from"),c=a.getCursor("to");if(0==e.cmpPos(d,c)){var f=r(a,
d);if(!f.word)return;d=f.from;c=f.to}return{from:d,to:c,query:a.getRange(d,c),word:f}}function A(a,d){var c=z(a);if(c){var f=c.query,b=a.getSearchCursor(f,d?c.to:c.from);(d?b.findNext():b.findPrevious())?a.setSelection(b.from(),b.to()):(b=a.getSearchCursor(f,d?m(a.firstLine(),0):a.clipPos(m(a.lastLine()))),(d?b.findNext():b.findPrevious())?a.setSelection(b.from(),b.to()):c.word&&a.setSelection(c.from,c.to))}}var b=e.keyMap.sublime={fallthrough:"default"},h=e.commands,m=e.Pos,u=e.keyMap["default"]==
e.keyMap.macDefault,k=u?"Cmd-":"Ctrl-",n=u?"Ctrl-":"Alt-";h[b[n+"Left"]="goSubwordLeft"]=function(a){q(a,-1)};h[b[n+"Right"]="goSubwordRight"]=function(a){q(a,1)};u&&(b["Cmd-Left"]="goLineStartSmart");n=u?"Ctrl-Alt-":"Ctrl-";h[b[n+"Up"]="scrollLineUp"]=function(a){var d=a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(d.top+d.clientHeight,"local");a.getCursor().line>=c&&a.execCommand("goLineUp")}a.scrollTo(null,d.top-a.defaultTextHeight())};h[b[n+"Down"]="scrollLineDown"]=function(a){var d=
a.getScrollInfo();if(!a.somethingSelected()){var c=a.lineAtHeight(d.top,"local")+1;a.getCursor().line<=c&&a.execCommand("goLineDown")}a.scrollTo(null,d.top+a.defaultTextHeight())};h[b["Shift-"+k+"L"]="splitSelectionByLine"]=function(a){for(var d=a.listSelections(),c=[],f=0;f<d.length;f++)for(var b=d[f].from(),e=d[f].to(),g=b.line;g<=e.line;++g)e.line>b.line&&g==e.line&&0==e.ch||c.push({anchor:g==b.line?b:m(g,0),head:g==e.line?e:m(g)});a.setSelections(c,0)};b["Shift-Tab"]="indentLess";h[b.Esc="singleSelectionTop"]=
function(a){var d=a.listSelections()[0];a.setSelection(d.anchor,d.head,{scroll:!1})};h[b[k+"L"]="selectLine"]=function(a){for(var d=a.listSelections(),c=[],f=0;f<d.length;f++){var b=d[f];c.push({anchor:m(b.from().line,0),head:m(b.to().line+1,0)})}a.setSelections(c)};b["Shift-Ctrl-K"]="deleteLine";h[b[k+"Enter"]="insertLineAfter"]=function(a){return p(a,!1)};h[b["Shift-"+k+"Enter"]="insertLineBefore"]=function(a){return p(a,!0)};h[b[k+"D"]="selectNextOccurrence"]=function(a){var d=a.getCursor("from"),
c=a.getCursor("to"),f=a.state.sublimeFindFullWord==a.doc.sel;if(0==e.cmpPos(d,c)){f=r(a,d);if(!f.word)return;a.setSelection(f.from,f.to);f=!0}else{var d=a.getRange(d,c),d=f?new RegExp("\\b"+d+"\\b"):d,c=a.getSearchCursor(d,c),b=c.findNext();b||(c=a.getSearchCursor(d,m(a.firstLine(),0)),b=c.findNext());if(!(d=!b))a:{for(var d=a.listSelections(),b=c.from(),h=c.to(),g=0;g<d.length;g++)if(d[g].from()==b&&d[g].to()==h){d=!0;break a}d=!1}if(d)return e.Pass;a.addSelection(c.from(),c.to())}f&&(a.state.sublimeFindFullWord=
a.doc.sel)};n=u?"Shift-Cmd":"Alt-Ctrl";h[b[n+"Up"]="addCursorToPrevLine"]=function(a){t(a,-1)};h[b[n+"Down"]="addCursorToNextLine"]=function(a){t(a,1)};h[b["Shift-"+k+"Space"]="selectScope"]=function(a){v(a)||a.execCommand("selectAll")};h[b["Shift-"+k+"M"]="selectBetweenBrackets"]=function(a){if(!v(a))return e.Pass};h[b[k+"M"]="goToBracket"]=function(a){a.extendSelectionsBy(function(d){var c=a.scanForBracket(d.head,1);return c&&0!=e.cmpPos(c.pos,d.head)?c.pos:(c=a.scanForBracket(d.head,-1))&&m(c.pos.line,
c.pos.ch+1)||d.head})};n=u?"Cmd-Ctrl-":"Shift-Ctrl-";h[b[n+"Up"]="swapLineUp"]=function(a){if(a.isReadOnly())return e.Pass;for(var d=a.listSelections(),c=[],b=a.firstLine()-1,l=[],h=0;h<d.length;h++){var g=d[h],k=g.from().line-1,n=g.to().line;l.push({anchor:m(g.anchor.line-1,g.anchor.ch),head:m(g.head.line-1,g.head.ch)});0!=g.to().ch||g.empty()||--n;k>b?c.push(k,n):c.length&&(c[c.length-1]=n);b=n}a.operation(function(){for(var d=0;d<c.length;d+=2){var b=c[d],f=c[d+1],g=a.getLine(b);a.replaceRange("",
m(b,0),m(b+1,0),"+swapLine");f>a.lastLine()?a.replaceRange("\n"+g,m(a.lastLine()),null,"+swapLine"):a.replaceRange(g+"\n",m(f,0),null,"+swapLine")}a.setSelections(l);a.scrollIntoView()})};h[b[n+"Down"]="swapLineDown"]=function(a){if(a.isReadOnly())return e.Pass;for(var d=a.listSelections(),c=[],b=a.lastLine()+1,l=d.length-1;0<=l;l--){var h=d[l],g=h.to().line+1,k=h.from().line;0!=h.to().ch||h.empty()||g--;g<b?c.push(g,k):c.length&&(c[c.length-1]=k);b=k}a.operation(function(){for(var d=c.length-2;0<=
d;d-=2){var b=c[d],f=c[d+1],g=a.getLine(b);b==a.lastLine()?a.replaceRange("",m(b-1),m(b),"+swapLine"):a.replaceRange("",m(b,0),m(b+1,0),"+swapLine");a.replaceRange(g+"\n",m(f,0),null,"+swapLine")}a.scrollIntoView()})};h[b[k+"/"]="toggleCommentIndented"]=function(a){a.toggleComment({indent:!0})};h[b[k+"J"]="joinLines"]=function(a){for(var d=a.listSelections(),c=[],b=0;b<d.length;b++){for(var e=d[b],h=e.from(),g=h.line,k=e.to().line;b<d.length-1&&d[b+1].from().line==k;)k=d[++b].to().line;c.push({start:g,
end:k,anchor:!e.empty()&&h})}a.operation(function(){for(var d=0,b=[],f=0;f<c.length;f++){for(var g=c[f],e=g.anchor&&m(g.anchor.line-d,g.anchor.ch),h,l=g.start;l<=g.end;l++){var k=l-d;l==g.end&&(h=m(k,a.getLine(k).length+1));k<a.lastLine()&&(a.replaceRange(" ",m(k),m(k+1,/^\s*/.exec(a.getLine(k+1))[0].length)),++d)}b.push({anchor:e||h,head:h})}a.setSelections(b,0)})};h[b["Shift-"+k+"D"]="duplicateLine"]=function(a){a.operation(function(){for(var d=a.listSelections().length,c=0;c<d;c++){var b=a.listSelections()[c];
b.empty()?a.replaceRange(a.getLine(b.head.line)+"\n",m(b.head.line,0)):a.replaceRange(a.getRange(b.from(),b.to()),b.from())}a.scrollIntoView()})};u||(b[k+"T"]="transposeChars");h[b.F9="sortLines"]=function(a){x(a,!0)};h[b[k+"F9"]="sortLinesInsensitive"]=function(a){x(a,!1)};h[b.F2="nextBookmark"]=function(a){var d=a.state.sublimeBookmarks;if(d)for(;d.length;){var c=d.shift(),b=c.find();if(b)return d.push(c),a.setSelection(b.from,b.to)}};h[b["Shift-F2"]="prevBookmark"]=function(a){var d=a.state.sublimeBookmarks;
if(d)for(;d.length;){d.unshift(d.pop());var c=d[d.length-1].find();if(c)return a.setSelection(c.from,c.to);d.pop()}};h[b[k+"F2"]="toggleBookmark"]=function(a){for(var d=a.listSelections(),c=a.state.sublimeBookmarks||(a.state.sublimeBookmarks=[]),b=0;b<d.length;b++){for(var e=d[b].from(),h=d[b].to(),g=a.findMarks(e,h),k=0;k<g.length;k++)if(g[k].sublimeBookmark){g[k].clear();for(var m=0;m<c.length;m++)c[m]==g[k]&&c.splice(m--,1);break}k==g.length&&c.push(a.markText(e,h,{sublimeBookmark:!0,clearWhenEmpty:!1}))}};
h[b["Shift-"+k+"F2"]="clearBookmarks"]=function(a){if(a=a.state.sublimeBookmarks)for(var d=0;d<a.length;d++)a[d].clear();a.length=0};h[b["Alt-F2"]="selectBookmarks"]=function(a){var d=a.state.sublimeBookmarks,c=[];if(d)for(var b=0;b<d.length;b++){var e=d[b].find();e?c.push({anchor:e.from,head:e.to}):d.splice(b--,0)}c.length&&a.setSelections(c,0)};b["Alt-Q"]="wrapLines";n=k+"K ";b[n+k+"Backspace"]="delLineLeft";h[b.Backspace="smartBackspace"]=function(a){if(a.somethingSelected())return e.Pass;a.operation(function(){for(var d=
a.listSelections(),c=a.getOption("indentUnit"),b=d.length-1;0<=b;b--){var h=d[b].head,k=a.getRange({line:h.line,ch:0},h),g=e.countColumn(k,null,a.getOption("tabSize")),n=a.findPosH(h,-1,"char",!1);k&&!/\S/.test(k)&&0==g%c&&(k=new m(h.line,e.findColumn(k,g-c,c)),k.ch!=h.ch&&(n=k));a.replaceRange("",n,h,"+delete")}})};h[b[n+k+"K"]="delLineRight"]=function(a){a.operation(function(){for(var d=a.listSelections(),b=d.length-1;0<=b;b--)a.replaceRange("",d[b].anchor,m(d[b].to().line),"+delete");a.scrollIntoView()})};
h[b[n+k+"U"]="upcaseAtCursor"]=function(a){y(a,function(a){return a.toUpperCase()})};h[b[n+k+"L"]="downcaseAtCursor"]=function(a){y(a,function(a){return a.toLowerCase()})};h[b[n+k+"Space"]="setSublimeMark"]=function(a){a.state.sublimeMark&&a.state.sublimeMark.clear();a.state.sublimeMark=a.setBookmark(a.getCursor())};h[b[n+k+"A"]="selectToSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&a.setSelection(a.getCursor(),b)};h[b[n+k+"W"]="deleteToSublimeMark"]=function(a){var b=
a.state.sublimeMark&&a.state.sublimeMark.find();if(b){var c=a.getCursor();if(0<e.cmpPos(c,b))var f=b,b=c,c=f;a.state.sublimeKilled=a.getRange(c,b);a.replaceRange("",c,b)}};h[b[n+k+"X"]="swapWithSublimeMark"]=function(a){var b=a.state.sublimeMark&&a.state.sublimeMark.find();b&&(a.state.sublimeMark.clear(),a.state.sublimeMark=a.setBookmark(a.getCursor()),a.setCursor(b))};h[b[n+k+"Y"]="sublimeYank"]=function(a){null!=a.state.sublimeKilled&&a.replaceSelection(a.state.sublimeKilled,null,"paste")};b[n+
k+"G"]="clearBookmarks";h[b[n+k+"C"]="showInCenter"]=function(a){var b=a.cursorCoords(null,"local");a.scrollTo(null,(b.top+b.bottom)/2-a.getScrollInfo().clientHeight/2)};u=u?"Ctrl-Shift-":"Ctrl-Alt-";h[b[u+"Up"]="selectLinesUpward"]=function(a){a.operation(function(){for(var b=a.listSelections(),c=0;c<b.length;c++){var f=b[c];f.head.line>a.firstLine()&&a.addSelection(m(f.head.line-1,f.head.ch))}})};h[b[u+"Down"]="selectLinesDownward"]=function(a){a.operation(function(){for(var b=a.listSelections(),
c=0;c<b.length;c++){var f=b[c];f.head.line<a.lastLine()&&a.addSelection(m(f.head.line+1,f.head.ch))}})};h[b[k+"F3"]="findUnder"]=function(a){A(a,!0)};h[b["Shift-"+k+"F3"]="findUnderPrevious"]=function(a){A(a,!1)};h[b["Alt-F3"]="findAllUnder"]=function(a){var b=z(a);if(b){for(var c=a.getSearchCursor(b.query),f=[],e=-1;c.findNext();)f.push({anchor:c.from(),head:c.to()}),c.from().line<=b.from.line&&c.from().ch<=b.from.ch&&e++;a.setSelections(f,e)}};b["Shift-"+k+"["]="fold";b["Shift-"+k+"]"]="unfold";
b[n+k+"0"]=b[n+k+"J"]="unfoldAll";b[k+"I"]="findIncremental";b["Shift-"+k+"I"]="findIncrementalReverse";b[k+"H"]="replace";b.F3="findNext";b["Shift-F3"]="findPrev";e.normalizeKeyMap(b)});
